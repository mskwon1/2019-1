# Data-Link layer protocols
## Piggybacking
- Simple, Stop-and-wait 프로토콜은 모두 단방향임
- 양방향, 한방향은 ACK과 함께 piggyback되어 보내짐
- 데이터 프레임과 ACK를 합해서 한번에 주고받음
- bandwidth를 아끼는 효과

## HDLC
- point-to-point, multipoint링크를 위한 bit-oriented protocol
- Stop-And-Wait 프로토콜을 구현
- 이론적인 프로토콜이지만, 다른 실용적인 프로토콜의 베이스가 되는 컨셉 ex) LAN, ethernet, PPP
### Transfer Modes
- 두개의 전송 모드를 제공하고, 서로 다른 곳에 쓰여짐
#### Normal Response Mode(NRM)
- Station configuration is unbalanced
- 하나의 primary station(명령 송신), 여러개의 secondary station(반응만 함)
- point-to-point & multipoint
#### Asynchronous Balanced Mode(ABM)
- Station configuration is balanced
- 하나의 primary station(명령 송신), 하나의 secondary station(반응만 함)
- point-to-point, 현재 흔하게 쓰임
### Framing
- 유연성을 제공하기 위해 3종류의 frame 제공
- Information Frames(I-Frames) : data-link user data, control information relating to user data(piggybacking)
  -> Flag + Address + Control + User Info + FCS + Flag
- Supervisory Frames(S-Frames) : control information만 전송
  -> Flag + Address + Control + FCS + Flag
- Unnumbered Frames(U-Frames) : data-link의 관리에 관련된 정보
  -> Flag + Address + Control + Management Info + FCS + Flag
#### Flag
- 프레임의 시작과 끝을 구분
- multiple frame 통신에서는 프레임이 한 프레임의 end와 바로 뒷 프레임의 start로 동시에 자리잡음
- ex) pattern : 01111110
#### Address
- Target station의 주소값 보관
- primary -> secondary(target station)
- secondary -> primary(target station)
- size : 1 ~ bytes
#### Control
- Flow and Error control에 사용
- size : 1~2 bytes
##### I-Frame
- 첫 1비트 : type(0 = I-Frame)
- N(S) 3비트 : Frame의 Sequence Number(0~7)
- P/F 1티트 : 1 = Poll(Primary -> Secondary) / 0 = Final(Secondary -> Primary)
- N(R) 3비트 : 프레임의 ACK num(piggybacking 사용시)
##### S-Frame
- 첫 2비트 : type(10 = S-Frame)
- Code 2비트 : S-Frame의 세부 타입
  -> 00(Receive Ready) : 받은 프레임(들)이 안전하고 단단하다는 acknowledgement -> N(R) = ACK num
  -> 10(Receive Not Ready) : Receiver가 너무 바빠 더이상 받을 수 없다는 acknowledgement -> N(R) = ACK num
                              sender에게 천천히 하라는 뜻을 보냄(congestion-control mechanism)
  -> 01(Reject) : Go Back-N ARQ에 쓰일 수 있는 NAK -> N(R) = NAK num
  -> 11(Selective Reject) : Selective Repeat ARQ에서 사용되는 NAK -> N(R) = NAK num
- P/F 1비트 : I-Frame과 동일
- N(R) 3비트 : ACK / Negative ACK(NAK) (piggybacking 사용시)
##### U-Frame
- Session management, control info between devices
- user data 대신 system management info를 가짐
- 첫 2비트 : type(11 = U-Frame)
- Code 2비트(prefix) : S-Frame과 같음
- P/F 1비트 : I-Frame과 같음
- Code 3비트(suffix) : prefix와 합쳐서 32개의 다른 U-Frame을 만드는 용도
#### Information
- user data, management information
#### FCS(Frame Check Sequence)
- 오류 감지 필드
- size : 2- ~ 4- 바이트, CRC

## PPP(Point-to-Point Protocol)
- point-to-point access를 목적으로 하는 **가장 흔한** 프로토콜
- 컴퓨터와 ISP를 연결할 때 대다수가 PPP 사용
- 데이터 전송을 control하고 manage하기 위해 필요
### Framing
- charater-oriented(byte-oriented) frame 사용
- Flag(1) + Address(1) + Control(1) + Protocol(1/2) + Payload(var) + FCS(2/4) + Flag
- Flag : 시작과 끝 구분
- Address : 상수 값 (11111111) - FF (broadcasting 주소)
- Control : 상수 값 (00000011) - PPP는 아무런 flow control도 제공하지 않음(에러 또한 탐지만 됨)
- Protocol : data field에 있는게 뭔지 정의(user data / other info)
- Payload : user data(max 1500 bytes), flag pattern이 여기서 나타날시 byte stuffing(esc = 01111101) 필요
- Frame Check Sequence(FCS) : 오류 탐지 필드(size = 2- ~ 4- byte CRC)
